<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>SIC Waitlist Registration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <style>
      .g-recaptcha {
        filter: invert(1) hue-rotate(180deg) !important;
        -webkit-filter: invert(1) hue-rotate(180deg) !important;
        margin-bottom: 0.5rem;
      }
      .grecaptcha-badge {
        filter: invert(1) hue-rotate(180deg) !important;
      }
    </style>
  </head>
  <body class="bg-black min-h-screen flex items-center justify-center p-4">
    <div
      id="loader-overlay"
      class="fixed inset-0 z-40 flex items-center justify-center bg-black bg-opacity-70 hidden"
    >
      <div class="flex flex-col items-center">
        <svg
          class="animate-spin h-12 w-12 text-[#45B4FF] mb-4"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="#45B4FF"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="#45B4FF"
            d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
          ></path>
        </svg>
        <span class="text-[#45B4FF] font-semibold">Submitting...</span>
      </div>
    </div>

    <div
      id="success-modal"
      class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 hidden"
    >
      <div
        class="bg-[#181A20] rounded-2xl shadow-2xl p-8 max-w-sm w-full border border-[#23262F] text-center"
      >
        <img
          src="https://res.cloudinary.com/dnyqwoeyh/image/upload/v1751353460/logo_rsvmqr.jpg"
          alt="Logo"
          class="w-16 h-16 mx-auto mb-4 rounded-full border-2 border-[#23262F]"
        />
        <h3 class="text-2xl font-bold mb-2" style="color: #45b4ff">
          Thank You!
        </h3>
        <p class="mb-4 text-[#45B4FF]">
          We have received your details.<br />We will contact you soon once
          college starts.
        </p>
        <button
          id="close-modal"
          class="mt-2 bg-[#45B4FF] hover:bg-[#1e90ff] text-black font-bold py-2 px-6 rounded-xl shadow transition"
        >
          Close
        </button>
      </div>
    </div>

    <form
      id="waitlist-form"
      class="bg-[#181A20] shadow-2xl rounded-2xl px-8 pt-8 pb-8 mb-4 w-full max-w-md space-y-6 border border-[#23262F]"
    >
      <div class="flex flex-col items-center mb-2">
        <img
          src="https://res.cloudinary.com/dnyqwoeyh/image/upload/v1751353460/logo_rsvmqr.jpg"
          alt="Logo"
          class="w-20 h-20 rounded-full shadow-lg mb-3 border-4 border-[#23262F]"
        />
        <h2 class="text-3xl font-extrabold text-center" style="color: #45b4ff">
          Join the Waitlist
        </h2>
        <p
          class="text-center text-base mt-1"
          style="color: #45b4ff; opacity: 0.8"
        >
          Be the first to join us
        </p>
      </div>

      <input
        type="text"
        name="name"
        placeholder="Your Name"
        required
        class="w-full p-3 bg-[#23262F] border border-[#353945] rounded-xl text-[#45B4FF] placeholder-[#45B4FF] focus:outline-none focus:ring-2 focus:ring-[#45B4FF] focus:bg-[#23262F] transition shadow-sm"
      />
      <input
        type="email"
        name="email"
        placeholder="Your Email"
        required
        class="w-full p-3 bg-[#23262F] border border-[#353945] rounded-xl text-[#45B4FF] placeholder-[#45B4FF] focus:outline-none focus:ring-2 focus:ring-[#45B4FF] focus:bg-[#23262F] transition shadow-sm"
      />
      <input
        type="text"
        name="phone"
        placeholder="Your Phone Number"
        required
        class="w-full p-3 bg-[#23262F] border border-[#353945] rounded-xl text-[#45B4FF] placeholder-[#45B4FF] focus:outline-none focus:ring-2 focus:ring-[#45B4FF] focus:bg-[#23262F] transition shadow-sm"
      />
      <textarea
        name="reason"
        placeholder="What contribution will you make after joining the community?"
        required
        rows="4"
        class="w-full p-3 bg-[#23262F] border border-[#353945] rounded-xl text-[#45B4FF] placeholder-[#45B4FF] focus:outline-none focus:ring-2 focus:ring-[#45B4FF] focus:bg-[#23262F] transition shadow-sm resize-none"
      ></textarea>

      <div
        class="g-recaptcha flex justify-center"
        data-sitekey="6LeymYYrAAAAADgX0OxY3ocZwhi_RDbEEq63pjiN"
      ></div>

      <button
        type="submit"
        class="bg-[#45B4FF] hover:bg-[#1e90ff] text-black font-bold py-3 px-4 rounded-xl w-full mt-4 shadow-lg transition transform hover:scale-[1.03] active:scale-95"
      >
        Submit
      </button>

      <p
        id="form-message"
        class="text-center text-sm mt-2"
        style="color: #45b4ff"
      ></p>
    </form>

    <script>
      const API_URL = "https://sic-waitlist-form.vercel.app";

      document
        .getElementById("waitlist-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const token = grecaptcha.getResponse();
          if (!token) {
            alert("Please complete the reCAPTCHA.");
            return;
          }

          const form = e.target;
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());
          data.token = token;

          document.getElementById("loader-overlay").classList.remove("hidden");

          fetch(`${API_URL}/api/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          })
            .then(async (res) => {
              const result = await res.json();
              document.getElementById("loader-overlay").classList.add("hidden");
              if (res.ok) {
                form.reset();
                grecaptcha.reset();
                document
                  .getElementById("success-modal")
                  .classList.remove("hidden");
                document.getElementById("form-message").textContent = "";
              } else {
                document.getElementById("form-message").textContent =
                  result.message || "Something went wrong. Please try again.";
              }
            })
            .catch(() => {
              document.getElementById("loader-overlay").classList.add("hidden");
              document.getElementById("form-message").textContent =
                "Something went wrong. Please try again.";
            });
        });

      document.getElementById("close-modal").onclick = function () {
        document.getElementById("success-modal").classList.add("hidden");
      };
    </script>
  </body>
</html>
